@page "/talep-olustur"
@rendermode InteractiveServer

@* Kullanıcının bu sayfayı görmesi için giriş yapmış olması gerekir *@
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize]

<h3>Yeni Yardım Talebi Oluştur</h3>

@* EditForm: Blazor'un form yönetim aracıdır.
    Model="@yeniTalep": Formun hangi C# nesnesiyle çalışacağını belirtir.
    OnValidSubmit="HandleTalepOlustur": Form geçerliyse (hata yoksa) hangi metodu çalıştıracağını belirtir.
*@
<EditForm Model="yeniTalep" OnValidSubmit="HandleTalepOlustur" FormName="TalepFormu">

    @* Hata kontrolü için (örn: Başlık boş bırakılırsa) *@
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="form-group">
        <label>Kategori:</label>
        <InputSelect @bind-Value="yeniTalep.KategoriId" class="form-control">
            <option value="0" disabled>-- Kategori Seçiniz --</option>
            @if (kategoriler != null)
            {
                @foreach (var kategori in kategoriler)
                {
                    <option value="@kategori.Id">@kategori.Ad</option>
                }
            }
        </InputSelect>
    </div>

    <div class="form-group">
        <label>Başlık:</label>
        <InputText @bind-Value="yeniTalep.Baslik" class="form-control" />
    </div>

    <div class="form-group">
        <label>Açıklama:</label>
        <InputTextArea @bind-Value="yeniTalep.Aciklama" class="form-control" />
    </div>

    <br />
    <button type="submit" class="btn btn-primary">Gönder</button>

    @if (!string.IsNullOrEmpty(mesaj))
    {
        <p class="text-success">@mesaj</p>
    }

</EditForm>